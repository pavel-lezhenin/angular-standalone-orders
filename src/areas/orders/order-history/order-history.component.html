<div class="order-history-page">
  <div class="order-history-container">
    <h1>Your Orders</h1>

    @if (loading()) {
      <p class="loading">Loading orders...</p>
    } @else if (error()) {
      <p class="error">{{ error() }}</p>
    } @else {
      @if (orders().length === 0) {
        <p class="empty">No orders found</p>
      } @else {
        <section class="orders-card">
          <div class="orders-table-wrapper">
            <table class="orders-table">
              <thead>
                <tr>
                  <th>Order ID</th>
                  <th>Total</th>
                  <th>Status</th>
                  <th>Delivery Address</th>
                  <th>Created</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                @for (order of paginatedOrders(); track order.id) {
                  <tr class="clickable-row" (click)="viewOrderDetails(order.id)">
                    <td>#{{ order.id.slice(0, 8) }}</td>
                    <td>{{ order.total | currency }}</td>
                    <td><span [class]="'status-' + order.status">{{ order.status }}</span></td>
                    <td class="address-cell">{{ order.deliveryAddress }}</td>
                    <td>{{ order.createdAt | date:'short' }}</td>
                    <td>
                      @if (canCancel(order)) {
                        <button
                          mat-stroked-button
                          type="button"
                          (click)="cancelOrder($event, order)"
                          [disabled]="isCanceling(order.id)"
                        >
                          <mat-icon>cancel</mat-icon>
                          Cancel
                        </button>
                      }
                    </td>
                  </tr>
                }
              </tbody>
            </table>
          </div>

          <div class="pagination-controls">
            <app-pagination
              [currentPage]="currentPage()"
              [totalPages]="totalPages()"
              (pageChange)="goToPage($event)"
            />
            <span class="pagination-caption">Page {{ currentPage() }} of {{ totalPages() }}</span>
          </div>
        </section>
      }
    }
  </div>
</div>
